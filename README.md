# auth
### Описание
Сервер аутентификации для внутренних сервисов.
### Требования к установке
Компьютер с Docker, установленными образами mongo:5, python:3.9-slim и с доступом в Интернет.
### Установка
1. В файле **config.yml** задать время жизни токенов, перечислить почты администраторов, почту и пароль для отправки писем   
_Нужен аккаунт Google и app password из двухэтапной аутентификации_ 
2. В файл **users.json** записать данные пользователей, для каждого указать почту по ключу `mail`
3. Из папки с проектом перейти в консоль
4. Выполнить сборку проекта  
`docker build . -t auth:1`
### Запуск
1. Из папки с проектом перейти в консоль
2. Запустить контейнеры приложения  
`docker-compose up -d`  
_При необходимости поменять хост, порт или временную зону в **docker-compose.yml**_
### После успешного запуска сервера
Страница с документацией на Swagger: [http://localhost:8000/docs](http://localhost:8000/docs)  
Страница с документацией на ReDoc: [http://localhost:8000/redoc](http://localhost:8000/redoc)  
_Если в **docker-compose.yml** был(и) изменен(ы) хост/порт, изменить его/их в url соответственно._ 
### Для запуска тестов
1. Запустить тестовый контейнер mongo, запомнить url для тестовой базы данных
2. Задать url для тестовой mongodb и время жизни токенов в файле **config.yml**, там же указать  
`use_fake_email_messenger: True`  
`use_test_db: True`
3. Для проекта создать виртуальное окружение и установить зависимости из **requirements.txt**
4. В настройках окружения, выбрать рабочую директорию - папку c этим README
5. Запустить тесты
